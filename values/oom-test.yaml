# DR-Kube 테스트용 애플리케이션 Values
# 에이전트가 이 파일을 수정하여 PR을 생성합니다

app:
  name: oom-test
  namespace: default

  # 레플리카 수
  replicas: 1

  # 컨테이너 설정
  container:
    name: stress-app
    image: polinux/stress
    tag: latest

    # 리소스 설정 (에이전트가 수정할 대상)
    resources:
      requests:
        memory: "256Mi" # OOMKilled 방지를 위해 요청 메모리 증가
        cpu: "50m"
      limits:
        memory: "256Mi" # 컨테이너가 요청하는 256M에 맞춰 메모리 제한 증가
        cpu: "100m"

    # stress 명령어
    command:
      - "stress"

    # stress 명령어 인자
    args:
      - "--vm"
      - "1"
      - "--vm-bytes"
      - "256M"  # 128Mi limit보다 큰 값으로 OOM 유발
      - "--vm-hang"
      - "1"

  # 레이블
  labels:
    scenario: oom-killed
    managed-by: dr-kube