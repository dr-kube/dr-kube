# DR-Kube 테스트용 애플리케이션 Values
# 에이전트가 이 파일을 수정하여 PR을 생성합니다

app:
  name: oom-test
  namespace: default

  # 레플리카 수
  replicas: 1

  # 컨테이너 설정
  container:
    name: stress-app
    image: polinux/stress
    tag: latest

    # 리소스 설정 (에이전트가 수정할 대상)
    resources:
      requests:
        memory: "512Mi"  # 실제 사용량(256M)을 안정적으로 수용하기 위해 상향 조정
        cpu: "500m"
      limits:
        memory: "1Gi"    # OOM 방지를 위해 충분한 여유 공간(Limit) 확보
        cpu: "1000m"     # CPU Throttling 방지를 위해 Limit 상향 조정

    # stress 명령어
    command:
      - "stress"

    # stress 명령어 인자
    args:
      - "--vm"
      - "1"
      - "--vm-bytes"
      - "256M"  # 설정된 리소스 Limit(1Gi)보다 작은 값으로 설정하여 OOM 방지
      - "--vm-hang"
      - "1"

  # 레이블
  labels:
    scenario: oom-killed
    managed-by: dr-kube