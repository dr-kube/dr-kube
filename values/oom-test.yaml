# DR-Kube 테스트용 애플리케이션 Values
# 에이전트가 이 파일을 수정하여 PR을 생성합니다

app:
  name: oom-test
  namespace: default

  # 레플리카 수
  replicas: 1

  # 컨테이너 설정
  container:
    name: stress-app
    image: polinux/stress
    tag: latest

    # 리소스 설정 (에이전트가 수정할 대상)
    resources:
      requests:
        memory: "256Mi"
        cpu: "50m"
      limits:
        memory: "512Mi"  # stress 인자(256M)보다 높게 설정하여 OOM 방지
        cpu: "100m"

    # stress 명령어
    command:
      - "stress"

    # stress 명령어 인자
    args:
      - "--vm"
      - "1"
      - "--vm-bytes"
      - "256M"  # 256M 사용량에 맞춰 리소스 Limit을 상향 조정함
      - "--vm-hang"
      - "1"

  # 레이블
  labels:
    scenario: oom-killed
    managed-by: dr-kube