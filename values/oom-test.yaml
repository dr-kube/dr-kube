# DR-Kube 테스트용 애플리케이션 Values
# 에이전트가 이 파일을 수정하여 PR을 생성합니다

app:
  name: oom-test
  namespace: default

  # 레플리카 수
  replicas: 1

  # 컨테이너 설정
  container:
    name: stress-app
    image: polinux/stress
    tag: latest

    # 리소스 설정 (에이전트가 수정할 대상)
    resources:
      requests:
        memory: "256Mi"
        cpu: "1000m"     # 워크로드 요구량에 맞춰 CPU Request 상향 조정
      limits:
        memory: "512Mi"  # OOM 방지를 위해 실제 사용량(256M)보다 높게 설정
        cpu: "2000m"     # CPU Throttling 방지를 위해 Limit을 1000m에서 2000m으로 상향 조정

    # stress 명령어
    command:
      - "stress"

    # stress 명령어 인자
    args:
      - "--vm"
      - "1"
      - "--vm-bytes"
      - "256M"  # 128Mi limit보다 큰 값으로 OOM 유발
      - "--vm-hang"
      - "1"

  # 레이블
  labels:
    scenario: oom-killed
    managed-by: dr-kube